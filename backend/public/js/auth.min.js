function checkAuth(){const token=localStorage.getItem("auth_token");const guestNav=document.getElementById("guest-nav");const userNav=document.getElementById("user-nav");const userName=document.getElementById("user-name");if(token){fetch("/api/me",{headers:{Authorization:`Bearer ${token}`}}).then(response=>{if(response.ok){return response.json()}throw new Error("Token is invalid")}).then(user=>{guestNav.classList.add("d-none");userNav.classList.remove("d-none");userName.textContent=user.name}).catch(error=>{localStorage.removeItem("auth_token");guestNav.classList.remove("d-none");userNav.classList.add("d-none")})}else{guestNav.classList.remove("d-none");userNav.classList.add("d-none")}}function logout(){const token=localStorage.getItem("auth_token");fetch("/api/logout",{method:"POST",headers:{Authorization:`Bearer ${token}`}}).finally(()=>{localStorage.removeItem("auth_token");window.location.href="login.html"})}setInterval(()=>{const token=localStorage.getItem("auth_token");if(token){fetch("/api/refresh",{method:"POST",headers:{Authorization:`Bearer ${token}`}}).then(response=>response.json()).then(data=>{if(data.access_token){localStorage.setItem("auth_token",data.access_token)}})}},1e3*60*55);document.addEventListener("DOMContentLoaded",function(){checkAuth();const logoutButton=document.getElementById("logout-button");if(logoutButton){logoutButton.addEventListener("click",function(e){e.preventDefault();logout()})}});