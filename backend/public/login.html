<!doctype html>
<html lang="fr">
	<head>
		<meta charset="UTF-8">
	    <meta name="viewport" content="width=device-width, initial-scale=1">
	    <title>Connexion - StageApp</title>
	    <meta name="description" content="Connectez-vous à votre compte StageApp" />
	    <meta name="keywords" content="Connexion, Stage, Cameroun" />
	    <meta name="author" content="StageApp" />
	    <!-- favicon -->
        <link href="images/favicon.ico" rel="shortcut icon">
		<!-- Bootstrap core CSS -->
	    <link href="../frontend 2/css/bootstrap.min.css" type="text/css" rel="stylesheet" />
        <link href="../frontend 2/css/materialdesignicons.min.css" rel="stylesheet" type="text/css" />
	    <!-- Custom  Css -->
	    <link href="../frontend 2/css/style.css" rel="stylesheet" type="text/css" id="theme-opt" />
	    <link href="../frontend 2/css/style-dark.css" rel="stylesheet" type="text/css" id="dark-theme-styles" />
	    <link href="css/themes.css" rel="stylesheet" type="text/css" />
	</head>

	<body>
        <!-- Navbar STart -->
        <header id="topnav" class="defaultscroll sticky">
            <div class="container">
                <a class="logo" href="index.html">
                    <span class="logo-light-mode">
                        <img src="../frontend 2/images/logo-dark.png" class="l-dark" alt="">
                        <img src="../frontend 2/images/logo-white.png" class="l-light" alt="">
                    </span>
                    <img src="../frontend 2/images/logo-white.png" class="logo-dark-mode" alt="">
                </a>

                <div class="menu-extras">
                    <div class="menu-item">
                        <a class="navbar-toggle" id="isToggle" onclick="toggleMenu()">
                            <div class="lines">
                                <span></span>
                                <span></span>
                                <span></span>
                            </div>
                        </a>
                    </div>
                </div>

                <ul class="buy-button list-inline mb-0">
                    <li class="list-inline-item ps-1 mb-0">
                        <div class="dropdown">
                            <button type="button" class="dropdown-toggle btn btn-sm btn-icon btn-pills btn-primary" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                <i data-feather="search" class="icons"></i>
                            </button>
                            <div class="dropdown-menu dd-menu dropdown-menu-end bg-white rounded border-0 mt-3 p-0" style="width: 240px;">
                                <div class="search-bar">
                                    <div id="itemSearch" class="menu-search mb-0">
                                        <form role="search" method="get" id="searchItemform" class="searchform">
                                            <input type="text" class="form-control rounded border" name="s" id="searchItem" placeholder="Rechercher...">
                                            <input type="submit" id="searchItemsubmit" value="Rechercher">
                                            <i data-feather="search" class="search-icon fea icon-sm"></i>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </li>

                    <!-- Theme Switcher -->
                    <li class="list-inline-item ps-1 mb-0">
                        <button id="theme-toggle" type="button" class="btn btn-sm btn-icon btn-pills btn-outline-primary" title="Toggle theme">
                            <!-- Sun Icon (Light Mode) -->
                            <svg id="theme-toggle-light-icon" class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                                <path d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.707.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 5.05A1 1 0 003.636 6.464l.707.707a1 1 0 001.414-1.414l-.707-.707zM3 11a1 1 0 100-2H2a1 1 0 100 2h1zM6.464 16.364a1 1 0 01-1.414 0l-.707-.707a1 1 0 011.414-1.414l.707.707a1 1 0 010 1.414z"></path>
                            </svg>
                            <!-- Moon Icon (Dark Mode) -->
                            <svg id="theme-toggle-dark-icon" class="w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                                <path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"></path>
                            </svg>
                        </button>
                    </li>

                    <li class="list-inline-item ps-1 mb-0">
                        <div class="dropdown dropdown-primary">
                            <button type="button" class="dropdown-toggle btn btn-sm btn-icon btn-pills btn-primary" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                <img src="images/team/01.jpg" class="img-fluid rounded-pill" alt="">
                            </button>
                            <div class="dropdown-menu dd-menu dropdown-menu-end bg-white rounded shadow border-0 mt-3">
                                <a href="profile.html" class="dropdown-item fw-medium fs-6"><i data-feather="user" class="fea icon-sm me-2 align-middle"></i>Profil</a>
                                <a href="profile.html" class="dropdown-item fw-medium fs-6"><i data-feather="settings" class="fea icon-sm me-2 align-middle"></i>Paramètres</a>
                                <div class="dropdown-divider border-top"></div>
                                <a href="login.html" class="dropdown-item fw-medium fs-6"><i data-feather="log-out" class="fea icon-sm me-2 align-middle"></i>Déconnexion</a>
                            </div>
                        </div>
                    </li>
                </ul>
        
                <div id="navigation">
                    <!-- Navigation Menu-->   
                    <ul class="navigation-menu nav-right nav-light">
                        <li class="has-submenu parent-menu-item">
                            <a href="javascript:void(0)">Accueil</a><span class="menu-arrow"></span>
                            <ul class="submenu">
                                <li><a href="index.html" class="sub-menu-item">Héros Un</a></li>
                            </ul>
                        </li>

                        <li class="has-submenu parent-parent-menu-item"><a href="javascript:void(0)"> Stages </a><span class="menu-arrow"></span>
                            <ul class="submenu">
                                <li><a href="offres-stage.html" class="sub-menu-item">Offres de Stage</a></li>
                        
                                <li class="has-submenu parent-menu-item">
                                    <a href="javascript:void(0)"> Grille de Stages </a><span class="submenu-arrow"></span>
                                    <ul class="submenu">
                                        <li><a href="offres-stage.html" class="sub-menu-item">Grille Un</a></li>
                                    </ul>  
                                </li>

                                <li><a href="offres-stage.html" class="sub-menu-item">Détail du Stage</a></li>
                            </ul>  
                        </li>
                
                        <li><a href="about.html" class="sub-menu-item">À propos</a></li>
                
                        <li><a href="faq.html" class="sub-menu-item">FAQ</a></li>
                
                        <li><a href="contact.html" class="sub-menu-item">Contact</a></li>
                    </ul><!--end navigation menu-->
                </div><!--end navigation-->
            </div>
        </header>
        <!-- Navbar End -->

        <!-- Login Hero -->
        <section class="bg-home d-flex align-items-center" style="background: url('images/hero/bg3.jpg') center;">
            <div class="bg-overlay bg-linear-gradient-2"></div>
            <div class="container">
                <div class="row">
                    <div class="col-lg-4 col-md-5 col-12">
                        <div class="p-4 bg-white rounded shadow-md mx-auto w-100" style="max-width: 400px;">
                            <form id="loginForm">
                                <a href="index.html"><img src="../frontend 2/images/logo-dark.png" class="mb-4 d-block mx-auto" alt=""></a>
                                <h6 class="mb-3 text-uppercase fw-semibold">Veuillez vous connecter</h6>
                            
                                <div class="mb-3">
                                    <label class="form-label fw-semibold">Votre Email</label>
                                    <input name="email" id="email" type="email" class="form-control" placeholder="example@website.com">
                                </div>

                                <div class="mb-3">
                                    <label class="form-label fw-semibold" for="loginpass">Mot de passe</label>
                                    <input type="password" class="form-control" id="password" placeholder="Mot de passe">
                                </div>
                            
                                <div class="d-flex justify-content-between">
                                    <div class="mb-3">
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" value="" id="flexCheckDefault">
                                            <label class="form-label form-check-label text-muted" for="flexCheckDefault">Se souvenir de moi</label>
                                        </div>
                                    </div>
                                    <span class="forgot-pass text-muted small mb-0"><a href="#" class="text-muted">Mot de passe oublié ?</a></span>
                                </div>
                 
                                <button class="btn btn-primary w-100" type="submit">Se connecter</button>

                                <div class="col-12 text-center mt-3">
                                    <span><span class="text-muted me-2 small">Vous n'avez pas de compte ?</span> <a href="signup.html" class="text-dark fw-semibold small">S'inscrire</a></span>
                                </div><!--end col-->
                            </form>
                        </div>
                    </div><!--end col-->
                </div><!--end row-->
            </div><!--end container-->
        </section><!--end section-->

        <!-- Style switcher -->
        <div id="style-switcher" class="bg-light border p-3 pt-2 pb-2" onclick="toggleSwitcher()">
            <div>
                <h6 class="title text-center mb-0">Option de Thème</h6>
                <ul class="text-center list-unstyled mb-0">
                    <li class="d-grid"><a href="javascript:void(0)" class="btn btn-sm btn-block btn-primary rtl-version t-rtl-light mt-2" onclick="setTheme('style-rtl')">RTL</a></li>
                    <li class="d-grid"><a href="javascript:void(0)" class="btn btn-sm btn-block btn-primary ltr-version t-ltr-light mt-2" onclick="setTheme('style')">LTR</a></li>
                    <li class="d-grid"><a href="javascript:void(0)" class="btn btn-sm btn-block btn-primary dark-rtl-version t-rtl-dark mt-2" onclick="setTheme('style-dark-rtl')">RTL</a></li>
                    <li class="d-grid"><a href="javascript:void(0)" class="btn btn-sm btn-block btn-primary dark-ltr-version t-ltr-dark mt-2" onclick="setTheme('style-dark')">LTR</a></li>
                    <li class="d-grid"><a href="javascript:void(0)" class="btn btn-sm btn-block btn-dark dark-version t-dark mt-2" onclick="setTheme('style-dark')">Sombre</a></li>
                    <li class="d-grid"><a href="javascript:void(0)" class="btn btn-sm btn-block btn-dark light-version t-light mt-2" onclick="setTheme('style')">Clair</a></li>
                </ul>

                <h6 class="title text-center pt-3 mb-0">Télécharger</h6>
                <ul class="text-center list-unstyled mb-0">
                    <li><a href="#" target="_blank" class="btn btn-sm btn-block btn-warning mt-2 w-100">Télécharger</a></li>
                </ul>
            </div>
            <div class="bottom p-0">
                <a href="javascript: void(0);" class="settings bg-white shadow d-block"><i class="mdi mdi-cog ms-1 mdi-24px position-absolute mdi-spin text-primary"></i></a>
            </div>
        </div>
        <!-- end Style switcher -->
        
        <!-- JAVASCRIPTS -->
	    <script src="../frontend 2/js/bootstrap.bundle.min.js"></script>
        <script src="../frontend 2/js/feather.min.js"></script>
	    <!-- Custom -->
	    <script src="../frontend 2/js/plugins.init.js"></script>
	    <script src="../frontend 2/js/app.js"></script>

        <!-- Preserve login JS -->
        <script src="js/auth.js"></script>

        <!-- Theme Switcher Script -->
        <script>
            // Professional Theme Switcher with Smooth Transitions
            document.addEventListener('DOMContentLoaded', function() {
                const themeToggleBtn = document.getElementById('theme-toggle');
                const themeToggleDarkIcon = document.getElementById('theme-toggle-dark-icon');
                const themeToggleLightIcon = document.getElementById('theme-toggle-light-icon');

                // Get system theme preference
                const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;

                // Initialize theme
                function initializeTheme() {
                    const savedTheme = localStorage.getItem('color-theme');
                    const systemTheme = prefersDark ? 'dark' : 'light';
                    const currentTheme = savedTheme || systemTheme;

                    setTheme(currentTheme);

                    // Listen for system theme changes
                    window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', function(e) {
                        if (!localStorage.getItem('color-theme')) {
                            setTheme(e.matches ? 'dark' : 'light');
                        }
                    });
                }

                // Set theme function
                function setTheme(theme) {
                    const body = document.body;
                    const html = document.documentElement;
                    const darkStyles = document.getElementById('dark-theme-styles');

                    if (theme === 'dark') {
                        html.classList.add('dark');
                        body.setAttribute('data-theme', 'dark');
                        if (darkStyles) {
                            darkStyles.media = 'all';
                        }
                        themeToggleLightIcon.classList.remove('hidden');
                        themeToggleDarkIcon.classList.add('hidden');
                    } else {
                        html.classList.remove('dark');
                        body.setAttribute('data-theme', 'light');
                        if (darkStyles) {
                            darkStyles.media = 'none';
                        }
                        themeToggleDarkIcon.classList.remove('hidden');
                        themeToggleLightIcon.classList.add('hidden');
                    }

                    // Add smooth transition class
                    html.style.setProperty('--theme-transition', 'all 0.3s ease');

                    // Save theme preference
                    localStorage.setItem('color-theme', theme);
                }

                // Toggle theme function
                function toggleTheme() {
                    const currentTheme = document.documentElement.classList.contains('dark') ? 'dark' : 'light';
                    const newTheme = currentTheme === 'dark' ? 'light' : 'dark';

                    // Add transition effect
                    document.documentElement.style.setProperty('--theme-transition', 'all 0.3s ease');

                    setTheme(newTheme);

                    // Add button animation
                    themeToggleBtn.style.transform = 'scale(0.95)';
                    setTimeout(() => {
                        themeToggleBtn.style.transform = 'scale(1)';
                    }, 150);
                }

                // Initialize theme on page load
                initializeTheme();

                // Add click event listener
                if (themeToggleBtn) {
                    themeToggleBtn.addEventListener('click', toggleTheme);

                    // Add keyboard support
                    themeToggleBtn.addEventListener('keydown', function(e) {
                        if (e.key === 'Enter' || e.key === ' ') {
                            e.preventDefault();
                            toggleTheme();
                        }
                    });

                    // Make button focusable
                    themeToggleBtn.setAttribute('tabindex', '0');
                    themeToggleBtn.setAttribute('role', 'button');
                    themeToggleBtn.setAttribute('aria-label', 'Toggle dark mode');
                }

                // Handle Login
                document.getElementById('loginForm').addEventListener('submit', async function(e) {
                    e.preventDefault();
                    const email = document.getElementById('email').value;
                    const password = document.getElementById('password').value;
                    const button = this.querySelector('button[type="submit"]');
                    const originalText = button.innerHTML;

                    button.innerHTML = `<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span> Connexion...`;
                    button.disabled = true;

                    try {
                        const response = await fetch('http://127.0.0.1:8000/api/auth/login', {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json',
                                'Accept': 'application/json'
                            },
                            body: JSON.stringify({ email, password })
                        });

                        const data = await response.json();

                        if (response.ok) {
                            localStorage.setItem('auth_token', data.access_token);
                            // Redirect based on user role
                            window.location.href = data.user.role === 'admin' ? 'admin-dashboard.html' : 'dashboard.html';
                        } else {
                            alert(data.message || 'Erreur de connexion.');
                        }
                    } catch (error) {
                        console.error('Login error:', error);
                        alert('Une erreur est survenue. Veuillez réessayer.');
                    } finally {
                        button.innerHTML = originalText;
                        button.disabled = false;
                    }
                });
            });
        </script>
    </body>
</html>